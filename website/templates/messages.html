{% extends "base.html" %}

{% block content %}
<div style="display: flex; height: 100%; margin-top: 20px;">

    <!-- Sidebar with Conversations and "Send a New Message" -->
    <div style="width: 30%; border-right: 1px solid #ccc; padding: 10px;">
        <h3>Send a New Message</h3>
        <form action="{{ url_for('views.send_message') }}" method="POST" style="margin-bottom: 20px;">
            <label for="receiver_email">Recipient's Email:</label><br>
            <input type="email" name="receiver_email" placeholder="Enter recipient's email" required style="width: 100%; margin-bottom: 10px;"><br>
            <textarea name="content" placeholder="Type your message..." required style="width: 100%;"></textarea><br>
            <button type="submit" style="width: 100%;">Send</button>
        </form>

        <h3>Conversations</h3>
        <ul>
            {% for user in users_contacted %}
                <li>
                    <a href="{{ url_for('views.messages', user_id=user.id) }}">
                        {{ user.name }} ({{ user.email }})
                    </a>
                </li>
            {% endfor %}
        </ul>
    </div>

    <!-- Conversation Area -->
    <div style="width: 70%; padding: 10px;">
        <h3>Conversation</h3>
        {% if conversation %}
            <ul>
                {% for message in conversation %}
                    <li>
                        <strong>{% if message.sender_id == current_user.id %}You{% else %}{{ message.sender.name }}{% endif %}:</strong>
                        {{ message.content }}
                        <small style="color: gray;">({{ message.timestamp }})</small>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>Select a user to view the conversation or start a new message on the left.</p>
        {% endif %}
    </div>

</div>
{% endblock %}

